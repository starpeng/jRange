(function(n,t,i,r){"use strict";var f=function(){return this.init.apply(this,arguments)},u;f.prototype={defaults:{onstatechange:function(){},isRange:!1,showLabels:!0,showScale:!0,step:1,format:"%s",theme:"theme-green",width:300,period:0,disable:!1},template:'<div class="slider-container">\t\t\t<div class="back-bar">                <div class="selected-bar"><\/div>                <div class="pointer low"><\/div><div class="pointer-label">123456<\/div>                <div class="pointer high"><\/div><div class="pointer-label">456789<\/div>                <div class="clickable-dummy"><\/div>            <\/div>            <div class="scale"><\/div>\t\t<\/div>',init:function(t,i){this.options=n.extend({},this.defaults,i);this.inputNode=n(t);this.options.value=this.inputNode.val()||(this.options.isRange?this.options.from+","+this.options.from:this.options.from);this.domNode=n(this.template);this.domNode.addClass(this.options.theme);this.inputNode.after(this.domNode);this.domNode.on("change",this.onChange);if(this.pointers=n(".pointer",this.domNode),this.lowPointer=this.pointers.first(),this.highPointer=this.pointers.last(),this.labels=n(".pointer-label",this.domNode),this.lowLabel=this.labels.first(),this.highLabel=this.labels.last(),this.scale=n(".scale",this.domNode),this.bar=n(".selected-bar",this.domNode),this.clickableBar=this.domNode.find(".clickable-dummy"),this.interval=this.options.to-this.options.from,this.interval==0){console.log("jRange : interval must great than 0!, returning");return}this.render()},render:function(){if(this.inputNode.width()!==0||this.options.width)this.domNode.width(this.options.width||this.inputNode.width()),this.inputNode.hide();else{console.log("jRange : no width found, returning");return}if(!this.isSingle()&&this.options.period>0){if(this.options.period>this.interval){console.log("jRange : period must less than interval, returning");return}this.period=this.options.period*this.domNode.width()/this.interval}else this.period=0;this.isSingle()&&(this.lowPointer.hide(),this.lowLabel.hide());this.options.showLabels||this.labels.hide();this.attachEvents();this.options.showScale&&this.renderScale();this.setValue(this.options.value)},isSingle:function(){return typeof this.options.value=="number"?!0:this.options.value.indexOf(",")!==-1||this.options.isRange?!1:!0},attachEvents:function(){this.clickableBar.click(n.proxy(this.barClicked,this));this.pointers.on("mousedown touchstart",n.proxy(this.onDragStart,this));this.pointers.bind("dragstart",function(n){n.preventDefault()})},onDragStart:function(t){if(!this.options.disable&&(t.type!=="mousedown"||t.which===1)){t.stopPropagation();t.preventDefault();var r=n(t.target);this.pointers.removeClass("last-active");r.addClass("focused last-active");this[(r.hasClass("low")?"low":"high")+"Label"].addClass("focused");n(i).on("mousemove.slider touchmove.slider",n.proxy(this.onDrag,this,r));n(i).on("mouseup.slider touchend.slider touchcancel.slider",n.proxy(this.onDragEnd,this))}},onDrag:function(n,t){t.stopPropagation();t.preventDefault();t.originalEvent.touches&&t.originalEvent.touches.length?t=t.originalEvent.touches[0]:t.originalEvent.changedTouches&&t.originalEvent.changedTouches.length&&(t=t.originalEvent.changedTouches[0]);var i=t.clientX-this.domNode.offset().left;this.domNode.trigger("change",[this,n,i])},onDragEnd:function(){this.pointers.removeClass("focused");this.labels.removeClass("focused");n(i).off(".slider")},barClicked:function(n){var t,i;this.options.disable||(t=n.pageX-this.clickableBar.offset().left,this.isSingle()?this.setPosition(this.pointers.last(),t,!0,!0):(i=Math.abs(parseInt(this.pointers.first().css("left"),10)-t+this.pointers.first().width()/2)<Math.abs(parseInt(this.pointers.last().css("left"),10)-t+this.pointers.first().width()/2)?this.pointers.first():this.pointers.last(),this.setPosition(i,t,!0,!0)))},onChange:function(n,t,i,r){var u,f,e;t.isSingle()?(u=0,f=t.domNode.width()):(u=i.hasClass("high")?t.lowPointer.position().left+t.lowPointer.width()/2+t.period:0,f=i.hasClass("low")?t.highPointer.position().left+t.highPointer.width()/2-t.period:t.domNode.width());e=Math.min(Math.max(r,u),f);t.setPosition(i,e,!0)},setPosition:function(n,t,i,r){var f,e=this.lowPointer.position().left,o=this.highPointer.position().left,u=this.highPointer.width()/2;i||(t=this.prcToPx(t));n[0]===this.highPointer[0]?o=Math.round(t-u):e=Math.round(t-u);n[r?"animate":"css"]({left:Math.round(t-u)});f=this.isSingle()?0:e+u;this.bar[r?"animate":"css"]({width:Math.round(o+u-f),left:f});this.showPointerValue(n,t,r);this.isReadonly()},setValue:function(n){var i=n.toString().split(","),t;this.options.value=n;t=this.valuesToPrc(i.length===2?i:[0,i[0]]);this.isSingle()?this.setPosition(this.highPointer,t[1]):(this.setPosition(this.lowPointer,t[0]),this.setPosition(this.highPointer,t[1]))},renderScale:function(){for(var i=this.options.scale||[this.options.from,this.options.to],u=Math.round(1e3/(i.length-1))/10,r="",t=0;t<i.length;t++)r+='<span style="left: '+t*u+'%">'+(i[t]!="|"?"<ins>"+i[t]+"<\/ins>":"")+"<\/span>";this.scale.html(r);n("ins",this.scale).each(function(){n(this).css({marginLeft:-n(this).outerWidth()/2})})},getBarWidth:function(){var n=this.options.value.split(",");return n.length>1?parseInt(n[1],10)-parseInt(n[0],10):parseInt(n[0],10)},showPointerValue:function(t,i,u){var h=n(".pointer-label",this.domNode)[t.hasClass("low")?"first":"last"](),e,o=this.positionToValue(i),c,s,f;n.isFunction(this.options.format)?(c=this.isSingle()?r:t.hasClass("low")?"low":"high",e=this.options.format(o,c)):e=this.options.format.replace("%s",o);s=h.html(e).width();f=i-s/2;f=Math.min(Math.max(f,0),this.options.width-s);h[u?"animate":"css"]({left:f});this.setInputValue(t,o)},valuesToPrc:function(n){var t=(n[0]-this.options.from)*100/this.interval,i=(n[1]-this.options.from)*100/this.interval;return[t,i]},prcToPx:function(n){return this.domNode.width()*n/100},positionToValue:function(n){var t=n/this.domNode.width()*this.interval;return t=t+this.options.from,Math.round(t/this.options.step)*this.options.step},setInputValue:function(n,t){if(this.isSingle())this.options.value=t.toString();else{var i=this.options.value.split(",");this.options.value=n.hasClass("low")?t+","+i[1]:i[0]+","+t}this.inputNode.val()!==this.options.value&&(this.inputNode.val(this.options.value),this.options.onstatechange.call(this,this.options.value))},getValue:function(){return this.options.value},isReadonly:function(){this.domNode.toggleClass("slider-readonly",this.options.disable)},disable:function(){this.options.disable=!0;this.isReadonly()},enable:function(){this.options.disable=!1;this.isReadonly()},toggleDisable:function(){this.options.disable=!this.options.disable;this.isReadonly()}};u="jRange";n.fn[u]=function(i){var e=arguments,r;return this.each(function(){var s=n(this),o=n.data(this,"plugin_"+u),h=typeof i=="object"&&i;o||(s.data("plugin_"+u,o=new f(this,h)),n(t).resize(function(){o.setValue(o.getValue())}));typeof i=="string"&&(r=o[i].apply(o,Array.prototype.slice.call(e,1)))}),r||this}})(jQuery,window,document)